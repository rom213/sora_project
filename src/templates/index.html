{% extends 'layout.html' %}

{% block titles %} Chat App {% endblock %}

{% block body %}
<div class="">

    <div>
        {% include 'header/header.html' %}
    </div>
    

    <div class="bg-[#A5D2FF] w-full h-full absolute  overflow-x-auto p-6 pt-20 pb-8 mt-9">
        {% include 'chatgroup/chatGroup.html' %}
    </div>
</div>





    <script>
        const { createApp, ref, onMounted } = Vue;

        createApp({
            setup() {
                const socket = ref(null);
                const messages = ref(JSON.parse('{{ messages|tojson|safe }}')); 
                let emojis = ref([
                'ðŸ˜€', 'ðŸ˜„', 'ðŸ˜', 'ðŸ˜‚', 'ðŸ¤£', 'ðŸ˜Š', 'ðŸ˜', 'ðŸ¥°', 'ðŸ¤­', 'ðŸ¤·',
                'ðŸ™‹â€â™€ï¸', 'ðŸ™‹', 'ðŸ™ˆ', 'ðŸ™‰', 'ðŸ™Š', 'ðŸ«¦', 'ðŸ¯', 'ðŸŒ¿', 'â˜˜', 'ðŸ€',
                'âš¡', 'ðŸ”¥', 'ðŸ’¥', 'â›ˆ', 'ðŸŒž', 'ðŸŽ„', 'ðŸ’', 'ðŸ˜¡', 'ðŸ˜”', 'ðŸ‰',
                'ðŸŠ', 'ðŸ‰', 'ðŸŠâ€â™‚ï¸', 'ðŸ„â€â™€ï¸', 'ðŸŽ¯', 'ðŸª‘', 'ðŸ‘©â€ðŸ¦¯', 'ðŸŽ‰', 'ðŸŽ‚', 'ðŸŽƒ',
                'ðŸ•¯', 'ðŸŽ', 'ðŸŽˆ', 'ðŸª', 'ðŸ©', 'ðŸ»', 'ðŸ¥‚', 'ðŸ¥³', 'ðŸ¤–', 'ðŸ‘¾',
                'ðŸ¤¡', 'ðŸ‘»', 'ðŸ‘½', 'ðŸ’€', 'ðŸŽƒ', 'ðŸŽ¨', 'ðŸŽ¤', 'ðŸŽ§', 'ðŸŽ·', 'ðŸŽ¸',
                'ðŸŽº', 'ðŸŽ»', 'ðŸ¥', 'ðŸŽ®', 'ðŸ–¥', 'ðŸ’»', 'ðŸ“±', 'ðŸ“·', 'ðŸ“º', 'â°',
                'ðŸ›', 'ðŸšª', 'ðŸ—', 'ðŸ›‹', 'ðŸš½', 'ðŸš¿', 'ðŸ›', 'ðŸ›’', 'ðŸš²', 'ðŸš•',
                'ðŸšŒ', 'ðŸšŽ', 'ðŸš“', 'ðŸš‘', 'ðŸš’', 'ðŸšœ', 'ðŸš›', 'ðŸš', 'ðŸš‚', 'ðŸš€',
                'ðŸŽ¢', 'ðŸŽ¡', 'ðŸŽ ', 'ðŸŽª', 'ðŸŽ¬', 'ðŸŽ­', 'ðŸ–¼', 'ðŸŽ³', 'ðŸŽ½', 'ðŸ…',
                'ðŸ†', 'ðŸ¥‡', 'ðŸ¥ˆ', 'ðŸ¥‰', 'âš½', 'ðŸ€', 'ðŸˆ', 'ðŸŽ¾', 'ðŸ', 'ðŸ“',
                'ðŸ¸', 'ðŸ’', 'ðŸ‘', 'ðŸ¥…', 'â›³', 'ðŸŽ£', 'ðŸ¤¿', 'ðŸŽ½', 'ðŸ¹', 'ðŸ§‘â€ðŸŽ¤',
                'ðŸ§‘â€ðŸ³', 'ðŸ§‘â€ðŸ”¬', 'ðŸ§‘â€ðŸš€', 'ðŸ‘¶', 'ðŸ‘¨â€ðŸ¼', 'ðŸ§“', 'ðŸ¦¸â€â™‚ï¸', 'ðŸ¦¸â€â™€ï¸', 'ðŸ¦¹â€â™‚ï¸', 'ðŸ¦¹â€â™€ï¸',
                'ðŸ§™â€â™‚ï¸', 'ðŸ§™â€â™€ï¸', 'ðŸ§šâ€â™‚ï¸', 'ðŸ§šâ€â™€ï¸', 'ðŸ§žâ€â™‚ï¸', 'ðŸ§žâ€â™€ï¸', 'ðŸ§œâ€â™‚ï¸', 'ðŸ§œâ€â™€ï¸', 'ðŸ§›â€â™‚ï¸', 'ðŸ§›â€â™€ï¸',
                'ðŸ§Ÿâ€â™‚ï¸', 'ðŸ§Ÿâ€â™€ï¸','ðŸ–•','ðŸ¥µ','ðŸ¤¤','ðŸ˜ˆ'
            ]);
                 // Cargar mensajes desde el servidor
                const message = ref('');

                const modalEmojis=ref(false);

                const toogleEmojis=()=>{
                    modalEmojis.value=!modalEmojis.value
                }

                const adEmoji=(value)=>{
                    message.value=message.value.concat(value)
                }
                
                const sendMessage = () => {
                    if (message.value) {
                        socket.value.emit('message', message.value);
                        message.value = '';
                    }
                };

                onMounted(() => {
                    socket.value = io.connect();
                    socket.value.on('message', (data) => {
                        messages.value.push(data[data.length-1]);
                    });
                });

                return {
                    messages,
                    message,
                    sendMessage,
                    emojis,
                    toogleEmojis,
                    modalEmojis,
                    adEmoji
                };
            }
        }).mount('#app');
    </script>
{% endblock %}

